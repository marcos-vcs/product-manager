<div class="container-fluid">

  <div class="row justify-content-center" *ngIf="!notFoundMessage">
    <div class="col-lg-8 mt-2 center">

        <button
        mat-raised-button
        class="ml-3 filter-set"
        [matMenuTriggerFor]="beforeMenu"
          ><mat-icon>filter_list</mat-icon>
        </button>

        <mat-menu #beforeMenu="matMenu" xPosition="before">
          <button
          [ngClass]="{'active-filter': filter === 'NAME'}"
          (click)="setFilterName();"
          mat-menu-item>
            Nome (Padrão)
          </button>

          <button
          [ngClass]="{'active-filter': filter === 'PHONE'}"
          (click)="setFilterPhone();"
          mat-menu-item>
            Telefone
          </button>

          <button
          [ngClass]="{'active-filter': filter === 'EMAIL'}"
          (click)="setFilterEmail();"
          mat-menu-item>
            E-mail
          </button>
        </mat-menu>

        <mat-form-field *ngIf="filter !== 'PHONE'" class="ml-5" style="width: 70%">
          <input
            (input)="find()"
            type="text"
            matInput
            placeholder="Buscar"
            name= "search"
            [(ngModel)]="search">
          <button (click)="find()" matSuffix mat-button><mat-icon >search</mat-icon></button>
        </mat-form-field>

        <mat-form-field *ngIf="filter === 'PHONE'" class="ml-5" style="width: 70%">
          <input
            (input)="find()"
            mask="(00) 00000-0000"
            type="text"
            matInput
            placeholder="Buscar"
            name= "search"
            [(ngModel)]="search">
          <button (click)="find()" matSuffix mat-button><mat-icon >search</mat-icon></button>
        </mat-form-field>

      </div>
  </div>

  <div *ngIf="loadState" class="row justify-content-center">
    <div class="col-lg-10 mt-5">
      <mat-spinner class="mx-auto"></mat-spinner>
    </div>
  </div>

  <div *ngIf="notFoundMessage && !loadState" class="row justify-content-center">
    <div class="col-lg-10 mt-5 center text-center not-found">
      <div>
        <img src="../../../assets/empty-trash.png" width="300" loading="lazy" alt="nenhum produto encontrado!">
      </div>
      Lixeira vazia!
    </div>
  </div>

  <div class="row mt-5 center" *ngIf="dataSource.data.length > 0 && !loadState">
    <div class="col" class="mat-elevation-z8 w-100">

      <div class="row mr-2 my-3" *ngIf="!notFoundMessage && !loadState">
        <div class="col-12">
          <button (click)="confirmDeleteAll()" mat-flat-button class="bg-delete-all py-2 px-2 float-right">
            <img src="../../../assets/delete.png" class="mr-2" alt="delete all image" width="30">
            <span class="allProducts">Limpar lixeira</span>
          </button>
          <button (click)="confirmRestoreAll()" mat-flat-button class="bg-restore-all py-2 px-2 mr-2 float-right">
            <img src="../../../assets/restore.png" class="mr-2" alt="restore all image" width="30">
            <span class="allProducts">Restaurar todos</span>
          </button>
        </div>
      </div>

      <table mat-table [dataSource]="dataSource"  *ngIf="!loadMore && !loadState">

        <!-- Name Column -->
        <ng-container class="tr" matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef class="name"> Nome </th>
          <td mat-cell *matCellDef="let element"> {{element.name | titlecase}} </td>
        </ng-container>

        <!-- Phone Column -->
        <ng-container class="tr phone" matColumnDef="phone">
          <th mat-header-cell *matHeaderCellDef class="phone"> Telefone </th>
          <td mat-cell *matCellDef="let element"> {{element.phone | mask: '(00) 00000-0000'}} </td>
        </ng-container>

        <!-- Email Column -->
        <ng-container class="tr email" matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef class="email"> E-mail </th>
          <td mat-cell *matCellDef="let element"> {{element.email}} </td>
        </ng-container>

        <!-- Observation Column -->
        <ng-container class="tr observation" matColumnDef="observation">
          <th mat-header-cell *matHeaderCellDef class="observation"> Observação </th>
          <td mat-cell *matCellDef="let element"> {{element.observation | titlecase}} </td>
        </ng-container>

        <!-- Actions Column -->
         <ng-container class="tr actions" matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="actions"> Opções </th>
          <td mat-cell *matCellDef="let element">
            <button (click)="confirmRestore(element)" mat-icon-button aria-label="Editar">
              <mat-icon>restore_page</mat-icon>
            </button>
            <button (click)="deleteVerify(element.code)" mat-icon-button aria-label="Excluir">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      <div class="row my-3" *ngIf="loadMore">
        <div class="col-12">
          <mat-spinner class="mx-auto"></mat-spinner>
        </div>
      </div>

    </div>
  </div>

  <div class="row" *ngIf="dataSource.data.length < max && dataSource.data.length !== 0">
    <div class="col mt-3 mb-5">

      <button
        (click)="load()"
        *ngIf="!search"
        type="button"
        [disabled]="loadState"
        class="btn btn-primary see-more">
          Veja mais
      </button>

      <button
        (click)="loadFind()"
        *ngIf="search"
        type="button"
        class="btn btn-primary see-more">
          Veja mais
      </button>

    </div>
  </div>

  <div class="row text-center w-100 mb-3 mt-4"
  *ngIf="dataSource.data.length === max && !loadState && !notFoundMessage">
    <div class="col">
      <span class="allSuppliers">
        Todos os fornecedores foram carregados!
      </span>
    </div>
  </div>

</div>
